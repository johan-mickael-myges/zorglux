{% extends 'base.html.twig' %}

{% set title = 'Zorglux - Inscription' %}
{% set description = "Devenez un membre de Zorglux et rejoignez notre communauté passionnée de blogueurs et de créateurs de contenu. Inscrivez-vous pour accéder à des outils de blogging puissants, des modèles personnalisables et des fonctionnalités SEO intégrées." %}
{% set logoUrl = 'https://zorglux-bucket.s3.eu-north-1.amazonaws.com/default/logo.png' %}

{% block title %}{{ title }}{% endblock %}

{% block meta %}
    <meta name="description" content="{{ description }}">
    <meta name="author" content="Zorglux">
{% endblock %}

{% block meta_og %}
    <meta property="og:title" content="{{ title }}">
    <meta property="og:description" content="{{ description }}">
    <meta property="og:image" content="{{ logoUrl }}">
    <meta property="og:url" content="{{ path('app_register') }}">
    <meta property="og:type" content="website">
{% endblock %}

{% block meta_twitter %}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ title }}">
    <meta name="twitter:description" content="{{ description }}">
    <meta name="twitter:image" content="{{ logoUrl }}">
{% endblock %}

{% block jsonld %}
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebPage",
            "headline": "{{ title }}",
            "description": "{{ description }}",
            "image": "{{ logoUrl }}",
            "author": {
                "@type": "Organization",
                "name": "Zorglux",
                "logo": "{{ logoUrl }}",
                "url": "https://www.zorglux.works"
            },
            "publisher": {
                "@type": "Organization",
                "name": "Zorglux",
                "logo": {
                    "@type": "ImageObject",
                    "url": "{{ logoUrl }}"
                }
            },
            "url": "{{ path('app_register') }}"
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "ItemList",
            "itemListElement": [
        {% for blog in blogs %}
            {
                "@type": "ListItem",
                "position": {{ loop.index }},
                "url": "{{ path('blog_read', { slug: blog.slug }) }}",
                "name": "{{ blog.title }}",
                "description": "{{ blog.description }}",
                "author": {
                    "@type": "Person",
                    "name": "{{ blog.author.username }}"
                },
                "image": "{{ blog.thumbnail }}"
            }{% if not loop.last %},{% endif %}
        {% endfor %}
        ]
    }
    </script>
{% endblock %}

{% block body_header %}
    {% include '@common/navbar.html.twig' %}
{% endblock %}

{% block body_content %}

    {% set inputClasses = 'border-b rounded-sm outline-none focus:border-black p-1' %}
    {% set textErrorClasses = 'mt-1 text-xs text-red-500' %}

    <twig:Container>
        {{ form_start(form, {
            attr: {
                class: 'mt-5 p-5 shadow'
            }
        }) }}
        <h1 class="text-3xl mb-2">Deviens un membre de Zorglux</h1>

        <div class="mb-3 flex flex-col">
            {{ form_label(form.username, null, {
                label_attr: {
                    class: 'text-sm'
                }
            }) }}
            {{ form_widget(form.username, {
                attr: {
                    class: inputClasses,
                }
            }) }}
            {% if form.username.vars.errors|length > 0 %}
                <div class="{{ textErrorClasses }}">
                    {{ form_errors(form.username) }}
                </div>
            {% endif %}
        </div>
        <div class="mb-3 flex flex-col">
            {{ form_label(form.plainPassword, null, {
                label_attr: {
                    class: 'text-sm'
                }
            }) }}
            {{ form_widget(form.plainPassword, {
                attr: {
                    class: inputClasses,
                }
            }) }}
            {% if form.plainPassword.vars.errors|length > 0 %}
                <div class="{{ textErrorClasses }}">
                    {{ form_errors(form.plainPassword) }}
                </div>
            {% endif %}
        </div>
        <div class="mb-3 flex flex-col">
            {{ form_label(form.confirmPassword, null, {
                label_attr: {
                    class: 'text-sm'
                }
            }) }}
            {{ form_widget(form.confirmPassword, {
                attr: {
                    class: inputClasses,
                }
            }) }}
            {% if form.confirmPassword.vars.errors|length > 0 %}
                <div class="{{ textErrorClasses }}">
                    {{ form_errors(form.confirmPassword) }}
                </div>
            {% endif %}
        </div>

        <input type="hidden" name="_csrf_token"
               value="{{ csrf_token('authenticate') }}"
        >

        <button class="bg-gray-800 text-white px-4 py-2 rounded w-full" type="submit">
            S'inscrire
        </button>
        <div class="mt-2 text-center text-xs">
            <p>Déjà membre ?</p>
            <a href="{{ path('app_login') }}" class="text-gray-700 font-bold">Connecte toi.</a>
        </div>
        {{ form_end(form) }}

        <div class="py-5">
            <h2 class="text-lg">Lire les posts récents</h2>
            {% include '@public/partials/latest-posts.html.twig' %}
        </div>
    </twig:Container>
{% endblock %}
